# 履歴タブ・分析タブの理想形ビジョン

**作成日**: 2025-11-18 01:10
**目的**: セット麻雀特化機能の方針と、履歴タブ・分析タブの理想の状態を定義

---

## 📊 現状（Before）

### 履歴タブ（HistoryTab）

**機能**:
- ✅ セッション一覧表示（日付降順）
- ✅ 各セッションカードに基本情報表示
  - 日付、モード、半荘数
  - 総合順位
  - 収支（±金額）
  - 平均着順
  - 着順回数（トップ/2着/3着/4着）
- ✅ セッション詳細ダイアログ
  - 総収支タブ（サマリー）
  - 半荘詳細タブ（各半荘の点数内訳）
- ✅ 削除機能

**UI構成**:
```
┌─────────────────────────┐
│ 📅 2025-11-17           │
│ 4人打ち | 3半荘         │
│ 総合順位: 2位           │
│ +5,000pt                │
│ 平均着順: 2.33位        │
│ 1位1回 2位1回 3位1回    │
│                     [✕] │
└─────────────────────────┘
```

### 分析タブ（AnalysisTab）

**機能**:
- ✅ フィルター機能
  - ユーザー選択（mainUser + 登録ユーザー）
  - 期間選択（今月/今年/特定年/全期間）
  - モード選択（4人打ち/3人打ち/全体）
- ✅ 統計表示
  - 半荘着順統計（回数、割合、平均着順）
  - 収支統計（プラス/マイナス/計/場代）
  - スコア統計（プラス/マイナス/計）
  - チップ統計（プラス/マイナス/計）
- ✅ グラフ表示
  - 着順分布円グラフ
  - 収支推移グラフ（累積/個別モード切り替え）

**UI構成**:
```
┌─────────────────────────┐
│ [ユーザー選択 ▼]        │
│ [期間選択 ▼] [モード▼] │
├─────────────────────────┤
│ 📊 半荘着順 | 💰 収支   │
│ 1位: 18回(25%)          │
│ ...                      │
├─────────────────────────┤
│ [着順分布円グラフ]      │
├─────────────────────────┤
│ [収支推移グラフ]        │
└─────────────────────────┘
```

---

## 🎯 変化後（After）

### 履歴タブ（HistoryTab）の変化

#### 追加機能

##### 1. セッション詳細ダイアログの拡張 ⭐
**元ドキュメント**: `01-FEATURE_IDEAS.md`

**機能**:
- 総収支タブに合計表示エリア追加
  - 総収支（全プレイヤー合計）
  - 総ポイント（全プレイヤー合計）
  - チップ合計（全プレイヤー合計）
  - 場代合計（全プレイヤー合計）

**UI変化**:
```
┌─────────────────────────┐
│ 2025-11-17 金曜麻雀会    │
│                          │
│ [総収支] [半荘詳細]      │ ← タブ
├─────────────────────────┤
│ 📊 合計                  │ ← NEW
│ 総収支: 0pt (ゼロサム)  │
│ 総ポイント: 0点         │
│ チップ合計: 0枚         │
│ 場代合計: 2,000円       │
├─────────────────────────┤
│ 1位 山田太郎 +15,000円  │
│ ...                      │
└─────────────────────────┘
```

##### 2. セッション共有機能（クリップボード） ⭐⭐
**元ドキュメント**: `03-SESSION_SHARE_CLIPBOARD.md`

**機能**:
- セッション詳細ダイアログに「📋 結果をコピー」ボタン
- ワンタップで結果をテキスト形式でクリップボードにコピー
- LINE/Twitter等に貼り付け可能

**コピーされるテキスト**:
```
📊 2025-11-18 金曜麻雀会
4人打ち・3半荘・標準ウマ

1位 山田太郎  +15,000円
2位 佐藤花子   +5,000円
3位 鈴木一郎   -8,000円
4位 田中次郎  -12,000円

麻雀アプリで記録
```

**UI変化**:
```
┌─────────────────────────┐
│ ...（セッション詳細）    │
├─────────────────────────┤
│ [📋 結果をコピー]        │ ← NEW
│ [編集] [削除] [閉じる]   │
└─────────────────────────┘
```

##### 3. セッション一言メモ表示
**元ドキュメント**: `01-FEATURE_IDEAS.md`

**機能**:
- セッションに一言メモを追加可能（「役満達成」「新メンバー参加」等）
- セッション一覧カードにメモ表示
- セッション詳細ダイアログにもメモ表示

**UI変化**:
```
┌─────────────────────────┐
│ 📅 2025-11-17           │
│ 4人打ち | 3半荘         │
│ 💬 山田さんが大三元達成！│ ← NEW
│ 総合順位: 2位           │
│ +5,000pt                │
└─────────────────────────┘
```

##### 4. テンプレート保存ボタン（将来構想）
**元ドキュメント**: `01-FEATURE_IDEAS.md`

**機能**:
- セッション詳細ダイアログに「このセッションをテンプレート保存」ボタン
- 既存セッションの設定（メンバー、ルール）をテンプレートとして保存
- 定例麻雀会の設定を簡単に再利用できる

---

### 分析タブ（AnalysisTab）の変化

#### 追加機能

##### 1. 基本成績セクション ⭐
**元ドキュメント**: `04-PLAYER_PROFILE_FUTURE_PLAN.md`, `05-PROFILE_VS_CURRENT_COMPARISON.md`

**機能**:
- 統合統計カードの上部に基本成績セクションを表示
- 総セッション数、総半荘数、総収支、平均収支、平均着順を一目で確認
- フィルター変更・ユーザー切り替えで自動更新

**UI変化**:
```
┌─────────────────────────┐
│ [ユーザー選択▼]         │
│ [期間▼] [モード▼]       │
├─────────────────────────┤
│ 📊 基本成績              │ ← NEW
│ 総セッション数   24回   │
│ 総半荘数         72局   │
│ 総収支       +45,000円  │
│ 平均収支     +1,875円/回│
│ 平均着順        2.36位  │
├─────────────────────────┤
│ 📊 半荘着順 | 💰 収支   │ ← 既存
│ 1位: 18回(25%)          │
│ ...                      │
├─────────────────────────┤
│ [着順分布円グラフ]      │ ← 既存
├─────────────────────────┤
│ [収支推移グラフ]        │ ← 既存
└─────────────────────────┘
```

##### 2. 記録セクション ⭐⭐⭐
**元ドキュメント**: `04-PLAYER_PROFILE_FUTURE_PLAN.md`, `05-PROFILE_VS_CURRENT_COMPARISON.md`

**機能**:
- 収支推移グラフの下に記録セクションを表示
- 半荘単位の最高/最低得点
- セッション単位の最高/最低得点/収支
- 連続トップ/ラス記録

**UI変化**:
```
┌─────────────────────────┐
│ [収支推移グラフ]        │ ← 既存
├─────────────────────────┤
│ 📈 記録                  │ ← NEW
├─────────────────────────┤
│ 半荘単位                 │
│ 最高得点  +28,000点     │
│ 最低得点  -32,000点     │
│                          │
│ セッション単位（得点）   │
│ 最高      +45,000点     │
│ 最低      -18,000点     │
│                          │
│ セッション単位（収支）   │
│ 最高      +22,500円     │
│ 最低       -9,000円     │
│                          │
│ 連続記録                 │
│ 連続トップ  4回         │
│ 連続ラス    2回         │
└─────────────────────────┘
```

**Phase 2実装内容（将来）**:

##### 3. 傾向分析セクション（Phase 2）
```
┌─────────────────────────┐
│ 📊 傾向分析              │
├─────────────────────────┤
│ モード別                 │
│ 4人打ち  +30,000円      │
│ 3人打ち  +15,000円      │
│                          │
│ 時間帯別                 │
│ 昼       +10,000円      │
│ 夜       +35,000円      │
│                          │
│ 曜日別                   │
│ 金曜日   +20,000円      │
│ 土曜日   +15,000円      │
│ 日曜日   +10,000円      │
└─────────────────────────┘
```

##### 4. 対戦相手別成績セクション（Phase 3）
```
┌─────────────────────────┐
│ 🎯 対戦相手別成績        │
├─────────────────────────┤
│ vs 佐藤花子              │
│ 対戦: 18回 収支: +12k   │
│ 勝率: 61.1%             │
│                          │
│ vs 鈴木一郎              │
│ 対戦: 20回 収支: -8k    │
│ 勝率: 40.0%             │
└─────────────────────────┘
```

---

## 🎨 全体のUI変化まとめ

### 履歴タブ

**Before**:
```
セッション一覧
  ↓ タップ
セッション詳細ダイアログ
  - 総収支タブ
  - 半荘詳細タブ
  [編集] [削除] [閉じる]
```

**After**:
```
セッション一覧（💬メモ表示追加）
  ↓ タップ
セッション詳細ダイアログ
  - 総収支タブ（📊合計表示追加）
  - 半荘詳細タブ
  [📋 結果をコピー] ← NEW
  [テンプレート保存] ← NEW（将来）
  [編集] [削除] [閉じる]
```

### 分析タブ

**Before**:
```
フィルター
  - ユーザー選択
  - 期間選択
  - モード選択

統計カード
  - 半荘着順
  - 収支
  - スコア
  - チップ

着順分布円グラフ

収支推移グラフ
```

**After**:
```
フィルター
  - ユーザー選択
  - 期間選択
  - モード選択

基本成績セクション ← NEW
  - 総セッション数/総半荘数
  - 総収支/平均収支
  - 平均着順

統計カード（既存のまま）
  - 半荘着順
  - 収支
  - スコア
  - チップ

着順分布円グラフ（既存のまま）

収支推移グラフ（既存のまま）

記録セクション ← NEW
  - 半荘単位の最高/最低得点
  - セッション単位の最高/最低得点/収支
  - 連続トップ/ラス記録

（Phase 2以降）
傾向分析セクション
対戦相手別成績セクション
```

---

## 🎯 ユーザー体験の変化

### 現状（Before）

**履歴タブ**:
- セッション一覧を見る
- 詳細で各半荘の内訳を確認
- 削除する

**分析タブ**:
- フィルターで期間・モードを絞る
- 統計を確認する（着順/収支/スコア/チップ）
- 着順分布円グラフを見る
- 収支推移グラフを見る

### 理想形（After）

**履歴タブ**:
- セッション一覧を見る（💬メモ付き）
- 詳細で各半荘の内訳を確認（📊合計表示あり）
- 📋 ワンタップで結果をLINE/Twitter等に共有
- 削除する

**分析タブ**:
- フィルターで期間・モードを絞る
- 📊 基本成績セクション
  - 総セッション数、総半荘数
  - 総収支、平均収支、平均着順
- 統計を確認する（着順/収支/スコア/チップ）
- 着順分布円グラフを見る
- 収支推移グラフを見る
- 📈 記録セクション
  - 半荘単位の最高/最低得点
  - セッション単位の最高/最低得点/収支
  - 連続トップ/ラス記録

**将来的な拡張（検討中）**:
- テンプレート機能（定例麻雀会の設定保存）
- 傾向分析セクション（時間帯/曜日別成績）
- 対戦相手別成績・相性分析
- 称号・バッジシステム
- 画像共有機能

---

## 📝 更新履歴

- **2025-11-19 19:45**: ビジョンドキュメント化
  - 実装計画（Phase区切り、工数見積もり、技術詳細）を削除
  - 「現状」と「理想形」のビジョンを明確化
  - プロフィールダイアログを削除し、分析タブ内セクション追加方式に変更
  - クリップボード出力例から⭕❌シンボル削除
- **2025-11-18 01:10**: 初版作成
